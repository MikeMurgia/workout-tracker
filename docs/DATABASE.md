# Workout Tracker Database Schema

## Personal Use Design (No Authentication)

This is a single-user workout tracker. No login required - just your data.

## Entity Relationship Diagram

```
┌─────────────────────┐
│    user_profile     │        (Single row - your settings)
├─────────────────────┤
│ id (PK)             │
│ display_name        │
│ weight_unit         │
│ body_weight         │
│ experience_level    │
└─────────────────────┘


┌─────────────────┐            ┌─────────────────────┐
│    workouts     │            │     exercises       │
├─────────────────┤            ├─────────────────────┤
│ id (PK)         │            │ id (PK)             │
│ workout_date    │            │ name                │
│ name            │            │ muscle_group        │
│ notes           │            │ movement_type       │
│ perceived_exer. │            │ equipment           │
│ start_time      │            │ is_compound         │
│ end_time        │            └─────────────────────┘
└─────────────────┘                      │
        │                                │
        │ (one workout has many sets)    │
        ▼                                │
┌────────────────────────────────────────┴───┐
│              workout_sets                  │
├────────────────────────────────────────────┤
│ id (PK)                                    │
│ workout_id (FK) ──────────────────────────>│ workouts
│ exercise_id (FK) ─────────────────────────>│ exercises
│ set_number                                 │
│ weight                                     │
│ reps                                       │
│ set_type (warmup/working/dropset/failure)  │
│ rpe                                        │
└────────────────────────────────────────────┘


┌─────────────────────┐       ┌─────────────────────┐
│       goals         │       │   personal_records  │
├─────────────────────┤       ├─────────────────────┤
│ exercise_id (FK)    │       │ exercise_id (FK)    │
│ goal_type           │       │ workout_set_id (FK) │
│ target_value        │       │ record_type         │
│ target_date         │       │ record_value        │
│ achieved            │       │ is_current          │
└─────────────────────┘       └─────────────────────┘


┌─────────────────────┐
│   body_weight_log   │        (Track your weight over time)
├─────────────────────┤
│ log_date            │
│ weight              │
│ notes               │
└─────────────────────┘
```

## Key Relationships

| Parent | Child | Relationship | Delete Behavior |
|--------|-------|--------------|-----------------|
| workouts | workout_sets | 1:many | CASCADE (delete workout = delete its sets) |
| exercises | workout_sets | 1:many | RESTRICT (can't delete exercise if used) |
| exercises | goals | 1:many | CASCADE |
| exercises | personal_records | 1:many | CASCADE |

## Why These Design Decisions?

### 1. UUIDs instead of Auto-increment IDs
- If you ever export/import data, no ID conflicts
- Can be generated by any service (Node, Python, Rust)
- Harder to accidentally reference wrong record

### 2. Single user_profile table
- No auth complexity for personal use
- Just stores your preferences (lbs vs kg, etc.)
- Physical stats optional but useful for predictions

### 3. Individual sets vs "3x10" notation
- Real workouts vary: "3x10" might actually be 10, 9, 8 reps
- Weights might change between sets
- Precise data = better ML predictions

### 4. Pre-populated exercises table
- Consistent naming (no "bench" vs "Bench Press")
- Categories enable muscle group analytics
- You can always add custom exercises

### 5. Body weight log
- Separate from profile (tracks over time)
- Useful for correlating strength to bodyweight
- One entry per day

## Common Queries This Schema Enables

```sql
-- Get all bench press sets over the last month
SELECT w.workout_date, ws.weight, ws.reps
FROM workout_sets ws
JOIN workouts w ON ws.workout_id = w.id
JOIN exercises e ON ws.exercise_id = e.id
WHERE e.name = 'Barbell Bench Press'
  AND w.workout_date > NOW() - INTERVAL '30 days'
ORDER BY w.workout_date;

-- Calculate weekly volume for legs
SELECT 
  DATE_TRUNC('week', w.workout_date) as week,
  SUM(ws.weight * ws.reps) as total_volume
FROM workout_sets ws
JOIN workouts w ON ws.workout_id = w.id
JOIN exercises e ON ws.exercise_id = e.id
WHERE e.muscle_group = 'legs'
GROUP BY DATE_TRUNC('week', w.workout_date)
ORDER BY week;

-- Get your current PRs
SELECT * FROM current_prs;

-- Weekly volume by muscle group
SELECT * FROM weekly_volume_by_muscle;
```

## Built-in Views

The schema includes these pre-built views for common queries:

| View | Purpose |
|------|---------|
| `workout_summary` | Each workout with total volume, set count, avg RPE |
| `exercise_progress` | Progress data for any exercise over time |
| `current_prs` | Your current personal records |
| `weekly_volume_by_muscle` | Volume breakdown by muscle group per week |

## Data Science Opportunities

This schema enables:

1. **Progress Prediction**: Time series of (date, weight, reps) per exercise
2. **1RM Estimation**: weight × reps → estimated max (Epley, Brzycki formulas)
3. **Volume Tracking**: weight × reps × sets over time
4. **Fatigue Detection**: RPE trends, perceived exertion correlation
5. **Recommendation Engine**: Muscle group balance, exercise variety
6. **Body Composition**: Strength relative to bodyweight trends